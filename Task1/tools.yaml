sources:
  my-bq-source:
    kind: bigquery
    project: qwiklabs-gcp-02-dbc60af259f0

tools:
  fetch_demographic_bq:
    kind: bigquery-sql
    source: my-bq-source
    parameters:
      - name: country
        type: string
        description: The country name.
    statement:
      SELECT age_group, ARRAY_AGG(DISTINCT interest) AS interests
      FROM `qwiklabs-gcp-02-dbc60af259f0.cepf.sales_data`
      WHERE LOWER(country) LIKE LOWER(CONCAT('%', @country, '%'))
      GROUP BY age_group
      ORDER BY SUM(sales) DESC
      LIMIT 1
    description:
      Use this tool to get demographic information from BigQuery table.

toolsets:
  my_bq_toolset:
    - fetch_demographic_bq
 Deloitte - Build a Multi-Agent Campaign System with ADK and Agent Engine
3 hours
universal_currency_alt
7 Credits
info
This lab may incorporate AI tools to support your learning.
CE294
Objective

This lab challenges you to build and deploy a multi-agent marketing campaign generation system on Google Cloud using the Agent Development Kit (ADK) and the Model Context Protocol (MCP). You also need to implement Cloud Run–based agents that communicate via Agent-to-Agent (A2A) messaging to perform distributed tasks, which include the following:

    Fetch demographics from BigQuery
    Analyze market trends using GCS and Google Search
    Generate creative assets (text and image) with Gemini and Imagen
    Estimate localized budgets using an external currency conversion API
    Aggregate all outputs into a final structured JSON campaign brief

Setup and requirements
Before you click the Start Lab button

Read these instructions. Labs are timed and you cannot pause them. The timer, which starts when you click Start Lab, shows how long Google Cloud resources will be made available to you.

This Qwiklabs hands-on lab lets you do the lab activities yourself in a real cloud environment, not in a simulation or demo environment. It does so by giving you new, temporary credentials that you use to sign in and access Google Cloud for the duration of the lab.
What you need

To complete this lab, you need:

    Access to a standard internet browser (Chrome browser recommended).
    Time to complete the lab.

Note: If you already have your own personal Google Cloud account or project, do not use it for this lab.

Note: If you are using a Pixelbook, open an Incognito window to run this lab.
How to start your lab and sign in to the Google Cloud Console

    Click the Start Lab button. If you need to pay for the lab, a pop-up opens for you to select your payment method. On the left is a panel populated with the temporary credentials that you must use for this lab.

Copy the username, and then click Open Google Console. The lab spins up resources, and then opens another tab that shows the Sign in page.

Tip: Open the tabs in separate windows, side-by-side.
If you see the Choose an account page, click Use Another Account.

    In the Sign in page, paste the username that you copied from the Connection Details panel. Then copy and paste the password.

    Important: You must use the credentials from the Connection Details panel. Do not use your Qwiklabs credentials. If you have your own Google Cloud account, do not use it for this lab (avoids incurring charges).

    Click through the subsequent pages:
        Accept the terms and conditions.
        Do not add recovery options or two-factor authentication (because this is a temporary account).
        Do not sign up for free trials.

After a few moments, the Cloud Console opens in this tab.
Note: You can view the menu with a list of Google Cloud Products and Services by clicking the Navigation menu at the top-left.
Challenge scenario

Here's a company overview of Cymbal Group:
Headquartered in Minneapolis, Minnesota, Cymbal currently employs 775,000 people worldwide and reported US $192 billion in revenue in 2019.

Cymbal has always been strongly committed to innovation, uncovering meaningful ways to transform industries and deliver better customer experiences. Cymbal’s branded businesses span multiple sectors including manufacturing, financial services, media, healthcare, retail, aviation, and education.

Cymbal Group has been making a rapid transition to a cloud-first operating model. Cymbal Bank, Superstore, and other Cymbal Group assets have all been adopting Google Cloud as part of their technology strategy.

Cymbal Group aims to automate personalized marketing campaigns using Google Cloud’s AI and the Agent Development Kit (ADK). They are building a modular, multi-agent system where agents use MCP for tool access and A2A messaging for coordination. Each agent handles tasks like demographic analysis, market research, creative content generation, and budget estimation—collaborating to produce a final JSON campaign brief.
Your challenge

As an AI Engineer at Cymbal Group, your task is to build and deploy a multi-agent marketing automation system using the Agent Development Kit (ADK). The system uses Agent-to-Agent (A2A) communication and integrates with tools like BigQuery, Google Cloud Storage, Vertex AI, a currency API, Cloud Run, and the Model Context Protocol (MCP) for tool integration.

    Implement the following:

        Data Analyst: Uses MCP (Model Context Protocol) to define a BigQuery tool that queries a BigQuery table to retrieve demographic insights (e.g., age group, interests) based on country.

        Market Researcher: Reads product briefs from Google Cloud Storage and uses Google Search to gather fashion trends and competitor data.

        Creative Director: Combines demographics and market insights to generate a campaign slogan, key messages, and an image prompt using Gemini and Imagen, then stores the generated image in Google Cloud Storage.

        Financial Analyst: Converts a campaign budget from USD to a local currency using a third-party currency exchange API.

        Campaign Orchestrator: Coordinates the above agents using Agent-to-Agent (A2A) messaging and compiles the full campaign brief.

    Deploy Creative Director and Financial Analyst as A2A-compatible Cloud Run services.

    Deploy the Campaign Orchestrator to Vertex AI Agent Engine.

    Test the Campaign Orchestrator agent and ensure that the final campaign brief includes demographics, market insights, creative content (text and images), and budget details in a valid JSON format.

Boilerplate code is provided for all the agents. Each agent includes clear TODO comments where key functionality must be implemented.

Your task is to complete the TODOs in each file to build and connect the system components.
Task 1. Deploy the Data Analyst agent with MCP integration

Your challenge is to set up a Data Analyst Agent using the ADK framework and the MCP tool. The agent must use MCP to connect to BigQuery and analyze demographic data to identify the highest-performing demographic segment in the specified region.
Set up the lab environment

    Open and authorize the Cloud Shell terminal.

